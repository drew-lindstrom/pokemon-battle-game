from main import Frame
from player import Player
from pokemon import Pokemon
from weather import Weather
from terrain import Terrain
import pytest


class TestMain:
    @pytest.fixture
    def test_frame(self):
        slowbro = Pokemon(
            "Slowbro",
            100,
            "Male",
            ("Scald", "Slack Off", "Future Sight", "Teleport"),
            None,
            None,
            (31, 31, 31, 31, 31, 31),
            (252, 0, 252, 0, 4, 0),
            "Relaxed",
        )
        tyranitar = Pokemon(
            "Tyranitar",
            100,
            "Male",
            ("Crunch", "Stealth Rock", "Toxic", "Earthquake"),
            None,
            None,
            (31, 31, 31, 31, 31, 31),
            (252, 0, 0, 0, 216, 40),
            "Careful",
        )
        tapu_lele = Pokemon(
            "Tapu Lele",
            100,
            None,
            ("Psychic", "Moonblast", "Focus Blast", "Psyshock"),
            "Psychic Surge",
            "Choice Specs",
            (31, 0, 31, 31, 31, 31),
            (0, 0, 0, 252, 4, 252),
            "Timid",
        )
        cinderace = Pokemon(
            "Cinderace",
            100,
            "Male",
            ("Pyro Ball", "U-turn", "Gunk Shot", "High Jump Kick"),
            "Libero",
            "Heavy Duty Boots",
            (31, 31, 31, 31, 31, 31),
            (0, 252, 0, 0, 4, 252),
            "Jolly",
        )
        p1 = Player([slowbro, tyranitar])
        p2 = Player([tapu_lele, cinderace])
        w = Weather()
        t = Terrain()
        test_frame = Frame(p1, p2, None, None, w, t)
        return test_frame, slowbro, tyranitar, tapu_lele, cinderace

    def test_update_cur_pokemon(self, test_frame):
        frame = test_frame[0]
        slowbro = test_frame[1]
        tyranitar = test_frame[2]
        tapu_lele = test_frame[3]
        cinderace = test_frame[4]
        assert frame.user == slowbro
        assert frame.target == tapu_lele
        frame.attacking_team.cur_pokemon = tyranitar
        frame.defending_team.cur_pokemon = cinderace
        frame.update_cur_pokemon()
        assert frame.user == tyranitar
        assert frame.target == cinderace